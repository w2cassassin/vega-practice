

# Сервис для сравнения разных версия расписания.  

### Сервис доступен по [ссылке](https://vega.mirea.ru/raspeditor/):
```
https://vega.mirea.ru/raspeditor/
```

## 1. Настройка приложения
#### 1. Загрузить исходники приложения
```
git clone https://vgit.mirea.ru/w3cassassin/schedule-compare
cd schedule-compare
```
#### 2. Переименовать файл .env.example в .env и заполнить все переменные
Описание переменных:
```
APP_HOST=0.0.0.0               # Хост приложения
APP_PORT=8000                  # Порт приложения внутри контейнера
DOCKER_PORT=8012               # Внешний порт для доступа к приложению
ROOT_PATH=/your-path            # Корневой путь для API

POSTGRES_HOST=db               # Имя хоста PostgreSQL
POSTGRES_PORT=5432             # Порт PostgreSQL внутри контейнера
POSTGRES_OUT_PORT=54333        # Внешний порт для PostgreSQL
POSTGRES_USER=postgres         # Имя пользователя PostgreSQL
POSTGRES_PASSWORD=yourpassword # Пароль для PostgreSQL
POSTGRES_DB=yourdatabase       # Имя базы данных

```
#### 3. Собрать и запустить контейнеры
``` 
sudo docker-compose up -d --build
```
## 2.Настройка nginx
#### 1. Добавить конфигурацию Nginx

Пример конфигурации:
```
server {
    ...

    #your-path = ROOT_PATH

    location /your-path { 
    rewrite ^/your-path$ /your-path/ permanent;
    }

    location /your-path/ {
        proxy_pass http://localhost:8012/; 
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme; # <- ВАЖНО
    }

}
```

## 3. Использование приложения

### 3.1. Поддерживаемые форматы файлов

Приложение поддерживает сравнение файлов расписаний в форматах **.xlsx** и **.ics**:

- **.xlsx**: файлы в формате Microsoft Excel, содержащие расписание.
- **.ics**: файлы календаря в формате iCalendar, широко используемые для обмена расписаниями.

### 3.2. Загрузка файлов для сравнения

Вы можете загрузить файлы расписаний для сравнения двумя способами:

1. **Загрузка файла с компьютера**:
   - В разделе "Загрузка файла" нажмите на кнопку "Выберите файл…".
   - Выберите файл формата **.xlsx** или **.ics** со своего компьютера.
   - Нажмите кнопку "Загрузить" для добавления файла в систему.

2. **Загрузка файла по ссылке**:
   - **Вариант 1**: Вставьте ссылку на файл расписания в формате **.ics** в поле "Ссылка на файл".
   - **Вариант 2**: Введите название группы в поле "Введите название группы" и нажмите кнопку "Найти". Если такая группа существует, поле "Ссылка на файл" заполнится автоматически.
   - Нажмите кнопку "Загрузить" для добавления файла в систему.

### 3.3. Получение ссылки на файл **.ics** расписания

Чтобы получить ссылку на файл расписания в формате **.ics**, выполните следующие шаги:

1. В разделе "Загрузка файла" найдите поле "Введите название группы".
2. Введите название вашей учебной группы **точно**, например: `КМБО-01-21`.
3. Нажмите кнопку "Найти":
   - Если группа найдена, в поле "Ссылка на файл" автоматически появится ссылка на соответствующий **.ics** файл расписания.
   - Если группа не найдена, убедитесь в правильности ввода названия и повторите попытку.
4. После появления ссылки нажмите кнопку "Загрузить" для добавления файла в систему.


### 3.4. Сравнение файлов расписания

После загрузки необходимых файлов вы можете выполнить их сравнение:

1. Перейдите в раздел "Сравнение файлов".
2. Выберите два файла для сравнения из выпадающих списков:
   - Первый файл: выберите исходное расписание.
   - Второй файл: выберите новое или изменённое расписание.
3. Чтобы сравнить несколько пар файлов, нажмите кнопку "Добавить еще пару" и повторите выбор файлов.
4. Нажмите кнопку "Сравнить файлы".
5. Дождитесь завершения процесса сравнения. В это время появится индикатор загрузки.
6. После завершения сравнения результаты отобразятся в таблице ниже.

**Примечание:** Можно сравнивать только файлы одинаковых типов (например, **.xlsx** с **.xlsx** и **.ics** с **.ics**).

### 3.5. Просмотр и интерпретация результатов

Результаты сравнения представлены в виде таблицы, содержащей информацию:

- **Количество изменений**: число изменений по различным категориям (предметы, преподаватели, аудитории, кампусы).
- **Изменения**: подробный список изменений с указанием группы, дня недели, номера пары и описания изменений.
- **Файл сравнения**: возможность скачать файл с результатами сравнений для детального анализа (доступно только при сравнении файлов формата **.xlsx**).


### 3.6. Дополнительные возможности

- **Удаление файлов**: в разделе "Доступные файлы" вы можете удалить ранее загруженные файлы, которые больше не нужны.
- **Обновление списка файлов**: нажмите кнопку "Обновить список файлов" для обновления отображаемых данных (если обновление не произошло автоматически).
